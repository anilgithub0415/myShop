"use strict";(self.webpackChunkEshop=self.webpackChunkEshop||[]).push([[675],{1675:(de,v,s)=>{s.r(v),s.d(v,{SellerModule:()=>se});var p=s(6895),c=s(7716),R=s(5567),h=s(655),e=s(4650),a=s(4006),Z=s(4350),g=s(7807),b=s(7596),T=s(6173),A=s(2011),f=s(2114),P=s(9165),U=s(4704);function O(r,t){if(1&r&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&r){var o=e.oxw();e.xp6(1),e.Oqu(o.mobileNumber)}}function S(r,t){1&r&&(e.TgZ(0,"span",14),e._uU(1," userid not provided. "),e.qZA())}function N(r,t){1&r&&(e.TgZ(0,"div"),e._uU(1,"userid is required."),e.qZA())}function I(r,t){1&r&&(e.TgZ(0,"div"),e._uU(1,"userid must be a 10-digit number."),e.qZA())}function J(r,t){if(1&r&&(e.TgZ(0,"div",15),e.YNc(1,N,2,0,"div",0),e.YNc(2,I,2,0,"div",0),e.qZA()),2&r){var o=e.oxw();e.xp6(1),e.Q6J("ngIf",null==o.f.userid||null==o.f.userid.errors?null:o.f.userid.errors.required),e.xp6(1),e.Q6J("ngIf",null==o.f.userid||null==o.f.userid.errors?null:o.f.userid.errors.pattern)}}function Y(r,t){1&r&&(e.TgZ(0,"span",14),e._uU(1," display_name not provided. "),e.qZA())}function M(r,t){1&r&&(e.TgZ(0,"div"),e._uU(1,"display_name is required."),e.qZA())}function x(r,t){1&r&&(e.TgZ(0,"div"),e._uU(1,"display_name must be at least 4 character length."),e.qZA())}function j(r,t){if(1&r&&(e.TgZ(0,"div",15),e.YNc(1,M,2,0,"div",0),e.YNc(2,x,2,0,"div",0),e.qZA()),2&r){var o=e.oxw();e.xp6(1),e.Q6J("ngIf",null==o.f.display_name||null==o.f.display_name.errors?null:o.f.display_name.errors.required),e.xp6(1),e.Q6J("ngIf",null==o.f.display_name||null==o.f.display_name.errors?null:o.f.display_name.errors.minlength)}}function F(r,t){1&r&&(e.TgZ(0,"span",14),e._uU(1," consumer_address not provided. "),e.qZA())}function q(r,t){1&r&&(e.TgZ(0,"div"),e._uU(1,"consumer_address is required."),e.qZA())}function Q(r,t){1&r&&(e.TgZ(0,"div"),e._uU(1,"consumer_address must be at least 20 character length."),e.qZA())}function E(r,t){if(1&r&&(e.TgZ(0,"div",15),e.YNc(1,q,2,0,"div",0),e.YNc(2,Q,2,0,"div",0),e.qZA()),2&r){var o=e.oxw();e.xp6(1),e.Q6J("ngIf",null==o.f.consumer_address||null==o.f.consumer_address.errors?null:o.f.consumer_address.errors.required),e.xp6(1),e.Q6J("ngIf",null==o.f.consumer_address||null==o.f.consumer_address.errors?null:o.f.consumer_address.errors.minlength)}}function G(r,t){1&r&&(e.TgZ(0,"div"),e._uU(1,"This number already registered"),e.qZA())}var z=function(){function r(t,o,n,i,l,u,d,m,ie,ae,ue,le,me){this.formBuilder=t,this.servProduct=o,this.servUser=n,this.servUserExtra=i,this.servSellercommission=l,this.servCategory=u,this.authServ=d,this.otpService=m,this.notify=ie,this.router=ae,this.route=ue,this.servAuth=le,this.location=me,this.alExists=!1,this.selectedSeller_id=null,this.formSaved=new e.vpe,this.addedit_OPmode="Add",this.isSubmitted=!1,this.isSubmitted_uploadform=!1,this.submitClicked="",this.passwordsMatchValidator=function(y){var C=y.get("password"),_=y.get("passwordRepeat");return C&&_&&C.value!==_.value?{passwordsMatch:!0}:null}}return r.prototype.ngOnInit=function(){return(0,h.mG)(this,void 0,void 0,function(){var o=this;return(0,h.Jh)(this,function(n){switch(n.label){case 0:return this.param_Customer_id=0,this.myForm=this.formBuilder.group({id:[""],userid:["",[a.kI.required,a.kI.pattern("^[0-9]{10}$")]],display_name:["",[a.kI.required,a.kI.minLength(4),a.kI.maxLength(50)]],consumer_address:["",[a.kI.required,a.kI.minLength(20),a.kI.maxLength(200)]]},{validators:this.passwordsMatchValidator}),this.route.params.subscribe(function(i){return o.mobileNumber=i.mobilenumber}),this.myForm.patchValue({userid:this.mobileNumber}),[4,this.alreadyExist_Consumer(this.mobileNumber,1,"pending",this.servAuth.currentUserValue.id)];case 1:return n.sent()&&this.myForm.patchValue({display_name:this.ExtraObj.display_name,consumer_address:this.ExtraObj.consumer_address}),[2]}})})},r.prototype.alreadyExist_Consumer=function(t,o,n,i){var l=this;return void 0===o&&(o=0),void 0===n&&(n=""),void 0===i&&(i=0),new Promise(function(u,d){l.servUserExtra.getConsumers(t,o,n,i).subscribe(function(m){console.log("getConsumer response for approve:"+JSON.stringify(m)),m[0]&&m[0].userid?(l.ExtraObj=m[0],u(!0)):u(!1)})})},r.prototype.preserved_alreadyExist_Consumer=function(t,o){var n=this;return new Promise(function(i,l){n.servUserExtra.getConsumers(t,o).subscribe(function(u){console.log("getConsumer response:"+JSON.stringify(u)),i(!(!u[0]||!u[0].userid))})})},Object.defineProperty(r.prototype,"errorControl",{get:function(){return this.myForm.controls},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"f",{get:function(){return this.myForm.controls},enumerable:!1,configurable:!0}),r.prototype.Register_Consumer_Request_ApproveReject=function(t){var o,n={mobileNumber:this.errorControl.userid.value,seller_id:null===(o=this.servAuth.currentUserValue)||void 0===o?void 0:o.id,approval_status:t,action:"register_request_approve"};this.servUserExtra.SendRegistrationRequest(n).subscribe()},r.prototype.Register_NewCustomernotinuse=function(){this.otpService.sendotpORregister({mobileNumber:this.errorControl.userid.value,display_name:this.errorControl.display_name.value,consumer_address:this.errorControl.consumer_address.value,password:this.errorControl.password.value,action:"register_request"},"register_request").subscribe(function(t){console.log("response of registring user:"+t)},function(t){console.error("Failed to register customer"),console.error(t)})},r.prototype.passwordValidator=function(t){var o=t.value;return o?/[A-Z]/.test(o)?/\d/.test(o)?o.length<5?{minlength:!0}:null:{digit:!0}:{uppercase:!0}:null},r.prototype.onApprove=function(){this.submitClicked="Approved"},r.prototype.onReject=function(){this.submitClicked="Rejected"},r.prototype.onSubmit=function(){this.myForm.valid?"Approved"==this.submitClicked?(this.Register_Consumer_Request_ApproveReject("approved"),alert("Request has been approved, Please ask consumer to login with his new credential"),this.location.back()):"Rejected"==this.submitClicked&&(this.Register_Consumer_Request_ApproveReject("rejected"),alert("Request has been rejected"),this.location.back()):alert("invalid form")},r.prototype.onSelectProduct=function(t){console.log("in onSelectProduct"),this.selectedSeller_id=t.id},r.\u0275fac=function(o){return new(o||r)(e.Y36(a.qu),e.Y36(Z.M),e.Y36(g.K),e.Y36(b.P),e.Y36(T.b),e.Y36(A.H),e.Y36(f.$),e.Y36(P.n),e.Y36(U.g),e.Y36(c.F0),e.Y36(c.gz),e.Y36(f.$),e.Y36(p.Ye))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-registerapproveconsumer"]],inputs:{param_Customer_id:"param_Customer_id"},outputs:{formSaved:"formSaved"},decls:34,vars:9,consts:[[4,"ngIf"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-4"],[1,"form-group"],["for","userid"],["readonly","","type","text","formControlName","userid","id","userid",1,"form-control"],["class","error",4,"ngIf"],["class","text-danger",4,"ngIf"],["for","display_name"],["type","text","formControlName","display_name","id","display_name",1,"form-control"],["for","consumer_address"],["type","text","formControlName","consumer_address","id","consumer_address",1,"form-control"],["type","submit",1,"btn","btn-primary",3,"click"],[1,"error"],[1,"text-danger"]],template:function(o,n){1&o&&(e.TgZ(0,"p"),e._uU(1,"registerapproveconsumer works!"),e.qZA(),e.TgZ(2,"p"),e._uU(3,"New Customer Online Approving Registration"),e.qZA(),e._uU(4,"\nmobilenumber:"),e.YNc(5,O,2,1,"span",0),e.TgZ(6,"form",1),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e.TgZ(7,"div",2)(8,"div",3)(9,"div",4)(10,"label",5),e._uU(11,"Mobile Number"),e.qZA(),e._UZ(12,"input",6),e.YNc(13,S,2,0,"span",7),e.YNc(14,J,3,2,"div",8),e.qZA()(),e.TgZ(15,"div",3)(16,"div",4)(17,"label",9),e._uU(18,"Customer Name"),e.qZA(),e._UZ(19,"input",10),e.YNc(20,Y,2,0,"span",7),e.YNc(21,j,3,2,"div",8),e.qZA()(),e.TgZ(22,"div",3)(23,"div",4)(24,"label",11),e._uU(25,"consumer_address"),e.qZA(),e._UZ(26,"input",12),e.YNc(27,F,2,0,"span",7),e.YNc(28,E,3,2,"div",8),e.qZA()()(),e.YNc(29,G,2,0,"div",0),e.TgZ(30,"button",13),e.NdJ("click",function(){return n.onApprove()}),e._uU(31,"Approve"),e.qZA(),e.TgZ(32,"button",13),e.NdJ("click",function(){return n.onReject()}),e._uU(33,"Reject"),e.qZA()()),2&o&&(e.xp6(5),e.Q6J("ngIf",n.mobileNumber),e.xp6(1),e.Q6J("formGroup",n.myForm),e.xp6(7),e.Q6J("ngIf",n.isSubmitted&&(null==n.errorControl.userid.errors?null:n.errorControl.userid.errors.required)),e.xp6(1),e.Q6J("ngIf",(null==n.f.userid?null:n.f.userid.invalid)&&((null==n.f.userid?null:n.f.userid.dirty)||(null==n.f.userid?null:n.f.userid.touched))),e.xp6(6),e.Q6J("ngIf",n.isSubmitted&&(null==n.errorControl.display_name.errors?null:n.errorControl.display_name.errors.required)),e.xp6(1),e.Q6J("ngIf",(null==n.f.display_name?null:n.f.display_name.invalid)&&((null==n.f.display_name?null:n.f.display_name.dirty)||(null==n.f.display_name?null:n.f.display_name.touched))),e.xp6(6),e.Q6J("ngIf",n.isSubmitted&&(null==n.errorControl.consumer_address.errors?null:n.errorControl.consumer_address.errors.required)),e.xp6(1),e.Q6J("ngIf",(null==n.f.consumer_address?null:n.f.consumer_address.invalid)&&((null==n.f.consumer_address?null:n.f.consumer_address.dirty)||(null==n.f.consumer_address?null:n.f.consumer_address.touched))),e.xp6(1),e.Q6J("ngIf",n.alExists))},dependencies:[p.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u]}),r}(),B=s(4766),K=s(529),V=s(6395),$=s(5474),H=s(6493),L=s(868);function X(r,t){if(1&r){var o=e.EpF();e.TgZ(0,"div")(1,"button",9),e.NdJ("click",function(){e.CHM(o);var l=e.oxw();return e.KtG(l.createOrder())}),e._uU(2,"Pay Commission"),e.qZA(),e._uU(3),e.qZA()}if(2&r){var n=e.oxw();e.xp6(3),e.hij("Rs. ",n.Commision_to_pay," ")}}function D(r,t){if(1&r){var o=e.EpF();e.TgZ(0,"div")(1,"razorpay",10),e.NdJ("paymentSuccess",function(l){e.CHM(o);var u=e.oxw();return e.KtG(u.handlePaymentSuccess(l))}),e.qZA()()}if(2&r){var n=e.oxw();e.xp6(1),e.Q6J("param_RP_Orderid",n.RPOrderid)("param_RP_Amount",n.RPamount)("param_RP_currency",n.RPcurrency)("param_RP_receipt",n.RPreceipt)("param_RP_Notes",n.RPnotes)}}function W(r,t){if(1&r){var o=e.EpF();e.TgZ(0,"tr",11)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td",11),e._uU(4),e.qZA(),e.TgZ(5,"td",11),e._uU(6),e.qZA(),e.TgZ(7,"td",11),e._uU(8),e.qZA(),e.TgZ(9,"td",12)(10,"input",13),e.NdJ("ngModelChange",function(u){var d=e.CHM(o);return e.KtG(d.$implicit.selected=u)})("change",function(){e.CHM(o);var u=e.oxw();return e.KtG(u.calculateCommission())}),e.qZA()()()}if(2&r){var n=t.$implicit,i=e.oxw();e.xp6(2),e.Oqu(n.orderId),e.xp6(2),e.Oqu(i.servCommon.GetDisplayNameByKey(i.users,"id",n.userId,"display_name")),e.xp6(2),e.hij(" ",n.EffectiveAmount," "),e.xp6(2),e.hij(" ",n.commission_applicable," "),e.xp6(2),e.Q6J("ngModel",n.selected)}}var w=function(){function r(t,o,n,i,l,u){var d=this;this.http=t,this.winRef=o,this.servOrderCommission=n,this.servAuth=i,this.servUser=l,this.servCommon=u,this.apiUrl=B.N.apiUrl,this.servAuth.currentUser.subscribe(function(m){return d.currentUser=m})}return r.prototype.ngOnInit=function(){var t=this;this.get_Users(),this.Get_Completed_Orders_Of_Sellers_For_PayCommission(),this.servOrderCommission.getSellerpaycommission().subscribe(function(o){return t.Sellerpaycommission=o}),setTimeout(function(){console.log("Sellerpaycommission:"+JSON.stringify(t.Sellerpaycommission)),t.Commision_to_pay=Math.ceil(t.Sellerpaycommission)},3e3)},r.prototype.calculateCommission=function(){var t=this.Unpaid_Commission_Orders_Of_Sellers.filter(function(o){return o.selected});this.Commision_to_pay=t.reduce(function(o,n){return o+n.commission_applicable},0),this.Commision_to_pay=Math.ceil(this.Commision_to_pay)},r.prototype.handlePaymentSuccess=function(t){console.log("m in payCommision of seller and Payment successful:",t);var n=this.Unpaid_Commission_Orders_Of_Sellers.filter(function(i){return i.selected}).map(function(i){return i.orderId}).join(",");console.log("comma seperated orderIds are:"+n),this.servOrderCommission.PayCommission_for_Orders(n).subscribe(function(i){console.log("orderIds:"+n+" being declared as PAID status for commission")})},r.prototype.createOrder=function(){var t=this,o=this.apiUrl+"Razor",n={amount:this.Commision_to_pay,currency:"INR",receipt:"RPreceipt",notes:"RPnotes"};console.log("creating order with options:"+JSON.stringify(n)),this.http.post(o,n).subscribe(function(i){console.log("rrrrrrrrrrrrresponse:"+JSON.stringify(i.id)),t.RPOrderid=i.id,t.RPamount=t.Commision_to_pay,t.RPcurrency="INR",t.RPreceipt="RPreceipt",t.RPnotes="RPnotes"})},r.prototype.Get_Completed_Orders_Of_Sellers_For_PayCommission=function(){var t=this;this.servOrderCommission.Get_Completed_Orders_Of_Sellers_For_PayCommission(this.currentUser.id,"Complete").subscribe(function(o){t.Unpaid_Commission_Orders_Of_Sellers=o,console.log("Unpaid_Commission_Orders_Of_Sellers:"+JSON.stringify(t.Unpaid_Commission_Orders_Of_Sellers)),t.Unpaid_Commission_Orders_Of_Sellers.forEach(function(n){n.selected=!0}),t.calculateCommission()})},r.prototype.get_Users=function(){var t=this;this.servUser.getUsers("").subscribe(function(o){t.users=o})},r.\u0275fac=function(o){return new(o||r)(e.Y36(K.eN),e.Y36(V.f),e.Y36($.E),e.Y36(f.$),e.Y36(g.K),e.Y36(H.v))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-paycommission"]],inputs:{events:"events"},decls:20,vars:3,consts:[[1,"row"],[1,"col-6>"],[4,"ngIf"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"table","table-striped"],[1,"text-primary"],["style","height: 5px;",4,"ngFor","ngForOf"],[1,"btn","btn-danger","btn-sm",3,"click"],[3,"param_RP_Orderid","param_RP_Amount","param_RP_currency","param_RP_receipt","param_RP_Notes","paymentSuccess"],[2,"height","5px"],[2,"display","none","height","5px"],["type","checkbox",3,"ngModel","ngModelChange","change"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,X,4,1,"div",2),e.YNc(3,D,2,5,"div",2),e.qZA()(),e.TgZ(4,"div",0)(5,"div",3)(6,"div",4)(7,"div",5)(8,"table",6)(9,"thead",7)(10,"th"),e._uU(11,"OrderId"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Customer"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"Amount"),e.qZA(),e.TgZ(16,"th"),e._uU(17,"Commission"),e.qZA()(),e.TgZ(18,"tbody"),e.YNc(19,W,11,5,"tr",8),e.qZA()()()()()()),2&o&&(e.xp6(2),e.Q6J("ngIf",!n.RPOrderid),e.xp6(1),e.Q6J("ngIf",n.RPOrderid),e.xp6(16),e.Q6J("ngForOf",n.Unpaid_Commission_Orders_Of_Sellers))},dependencies:[L.v,p.sg,p.O5,a.Wl,a.JJ,a.On]}),r}(),ee=[{path:"aa",component:s(7557).N},{path:"",loadChildren:function(){return s.e(317).then(s.bind(s,317)).then(function(r){return r.ManageProductsModule})}},{path:"manage_product",loadChildren:function(){return s.e(317).then(s.bind(s,317)).then(function(r){return r.ManageProductsModule})}},{path:"manage_orders",loadChildren:function(){return Promise.all([s.e(592),s.e(509)]).then(s.bind(s,4509)).then(function(r){return r.ManageOrdersModule})}},{path:"manage_promotions",loadChildren:function(){return Promise.all([s.e(592),s.e(10)]).then(s.bind(s,9010)).then(function(r){return r.ManagePromotionsModule})}},{path:"paycommission",component:w},{path:"dboy",component:R.l},{path:"registerapproveconsumer/:mobilenumber",component:z},{path:"users",loadChildren:function(){return s.e(480).then(s.bind(s,5480)).then(function(r){return r.ManageUsersModule})}}],re=function(){function r(){}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[c.Bz.forChild(ee),c.Bz]}),r}(),oe=s(3738),ne=s(460),te=s(1633),se=function(){function r(){}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[te.m,p.ez,a.u5,a.UX,oe.W,ne.kn.forRoot(),re]}),r}()}}]);