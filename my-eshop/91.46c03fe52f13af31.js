"use strict";(self.webpackChunkmyEshop=self.webpackChunkmyEshop||[]).push([[91],{91:(B,l,n)=>{n.r(l),n.d(l,{ManagePromotionsModule:()=>Q});var p=n(6895),c=n(7716),o=n(5062),f=function(){function t(){}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-manage-promotions"]],decls:5,vars:0,consts:[["routerLink","Product-Promotions"],["routerLink","Order-Promotions"]],template:function(e,i){1&e&&(o.TgZ(0,"a",0),o._uU(1,"Product-Promotions"),o.qZA(),o.TgZ(2,"a",1),o._uU(3,"Order-Promotions"),o.qZA(),o._UZ(4,"router-outlet"))},dependencies:[c.lC,c.rH]}),t}(),Z=n(5529),C=n(7122),_=n(3607),h=n(5760),b=n(2340),A=function(){function t(){}return t.prototype.deserialize=function(r){return Object.assign(this,r),this},t}(),S=n(529),g=function(){function t(r){this.http=r,this.apiUrl=b.N.apiUrl}return t.prototype.getPromotionMast=function(){return this.http.get(this.apiUrl+"promotionmast/")},t.prototype.get_Promotion_ProductById=function(r){void 0===r&&(r=0);var e=this.apiUrl+"promotionproduct/"+r+"/0";return console.log("url to retrieve promo product by id:"+e),this.http.get(e)},t.prototype.get_Promotion_Product_Seller=function(r){void 0===r&&(r=0);var e=this.apiUrl+"promotionproduct/0/"+r;return console.log("url for service promo product for seller id:"+e),this.http.get(e)},t.prototype.addPromotion_Product=function(r){var e=this.apiUrl+"promotionproduct/";return console.log("submitting Promotion_Product:"+JSON.stringify(r)),this.http.post(e,r)},t.prototype.editPromotion_Product=function(r){var e=this.apiUrl+"promotionproduct/"+r.id;return console.log("editing promo with url:"+e),this.http.post(e,r)},t.prototype.get_Promotion_Order=function(r){return void 0===r&&(r=0),this.http.get(this.apiUrl+"promotionOrder/"+r)},t.prototype.get_Promotion_Order_Seller=function(r){return void 0===r&&(r=0),this.http.get(this.apiUrl+"promotionOrder/"+r)},t.prototype.addPromotion_Order=function(r){return this.http.post(this.apiUrl+"promotionOrder/",A)},t.\u0275fac=function(e){return new(e||t)(o.LFG(S.eN))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),P=n(1716),T=n(693);function U(t,r){if(1&t){var e=o.EpF();o.TgZ(0,"tr",4)(1,"td",4),o._uU(2),o.qZA(),o.TgZ(3,"td",4),o._uU(4),o.qZA(),o.TgZ(5,"td",4),o._uU(6),o.qZA(),o.TgZ(7,"td",4),o._uU(8),o.qZA(),o.TgZ(9,"td",4),o._uU(10),o.qZA(),o.TgZ(11,"td")(12,"button",5),o.NdJ("click",function(){var I=o.CHM(e).$implicit,k=o.oxw();return o.KtG(k.editProduct(I))}),o._uU(13,"Change"),o.qZA()()()}if(2&t){var i=r.$implicit,d=o.oxw();o.xp6(2),o.Oqu(i.id),o.xp6(2),o.Oqu(i.seller_id),o.xp6(2),o.Oqu(d.servCommon.GetDisplayNameByKey(d.products,"id",i.productId,"product_name")),o.xp6(2),o.Oqu(i.promotionName),o.xp6(2),o.Oqu(d.servCommon.GetDisplayNameByKey(d.sellerList,"id",i.seller_id,"display_name"))}}var O=function(){function t(r,e,i,d,u,a){this.servCommon=r,this.servCategory=e,this.servProduct=i,this.servPromoProduct=d,this.authServ=u,this.servUser=a,this.promoproduct_id_for_Addedit=new o.vpe,this.product_id_for_Detail=new o.vpe,this.product_id_Selected=new o.vpe,this.categoryList=[],this.sellerList=[]}return t.prototype.ngOnInit=function(){var r=this;this.getProductList(),this.get_product_promotions(),this.getSellerList(),this.getCategories(),this.eventsSubscription=this.events.subscribe(function(){return r.get_product_promotions()})},t.prototype.getCategories=function(){var r=this;this.servCategory.getCategorys().subscribe(function(e){r.categoryList=e})},t.prototype.getSellerList=function(){var r=this;this.servUser.getUsers_Of_role("Seller").subscribe(function(e){r.sellerList=e})},t.prototype.ngOnDestroy=function(){this.eventsSubscription.unsubscribe()},t.prototype.addProduct=function(){this.promoproduct_id_for_Addedit.emit(0)},t.prototype.editProduct=function(r){this.product_id_for_Detail.emit(void 0),this.promoproduct_id_for_Addedit.emit(r.id)},t.prototype.selectProduct=function(r){this.promoproduct_id_for_Addedit.emit(void 0),this.product_id_for_Detail.emit(r.id)},t.prototype.getProductList=function(){var r=this;this.servProduct.getProducts_All().subscribe(function(e){r.products=e})},t.prototype.get_product_promotions=function(){var r=this;this.servPromoProduct.get_Promotion_Product_Seller(this.authServ.currentUserValue.id).subscribe(function(e){r.promotions_product=e})},t.\u0275fac=function(e){return new(e||t)(o.Y36(C.v),o.Y36(_.H),o.Y36(h.M),o.Y36(g),o.Y36(P.$),o.Y36(T.K))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-display-product-promotion"]],inputs:{events:"events"},outputs:{promoproduct_id_for_Addedit:"promoproduct_id_for_Addedit",product_id_for_Detail:"product_id_for_Detail",product_id_Selected:"product_id_Selected"},decls:18,vars:1,consts:[[1,"btn","btn-sm","btn-danger",3,"click"],[1,"table","table-striped"],["scope","col"],["style","height: 5px;",4,"ngFor","ngForOf"],[2,"height","5px"],[1,"btn","btn-danger",3,"click"]],template:function(e,i){1&e&&(o.TgZ(0,"button",0),o.NdJ("click",function(){return i.addProduct()}),o._uU(1,"New Promotion"),o.qZA(),o.TgZ(2,"table",1)(3,"thead")(4,"tr")(5,"th"),o._uU(6,"ID"),o.qZA(),o.TgZ(7,"th"),o._uU(8,"Sellerid"),o.qZA(),o.TgZ(9,"th"),o._uU(10,"Product"),o.qZA(),o.TgZ(11,"th"),o._uU(12,"Promotion"),o.qZA(),o.TgZ(13,"th"),o._uU(14,"Seller"),o.qZA(),o._UZ(15,"th",2),o.qZA()(),o.TgZ(16,"tbody"),o.YNc(17,U,14,5,"tr",3),o.qZA()()),2&e&&(o.xp6(17),o.Q6J("ngForOf",i.promotions_product))},dependencies:[p.sg]}),t}(),v=n(655),s=n(4719),y=n(6776),m=n(9800);function q(t,r){if(1&t&&(o.TgZ(0,"option",23),o._uU(1),o.qZA()),2&t){var e=r.$implicit;o.Q6J("value",e.id),o.xp6(1),o.Oqu(e.product_name)}}function N(t,r){1&t&&(o.TgZ(0,"span",24),o._uU(1," Product not provided. "),o.qZA())}function F(t,r){if(1&t&&(o.TgZ(0,"option",23),o._uU(1),o.qZA()),2&t){var e=r.$implicit;o.Q6J("value",e.promotionType),o.xp6(1),o.Oqu(e.promotionType)}}function J(t,r){1&t&&(o.TgZ(0,"span",24),o._uU(1," promoType not provided. "),o.qZA())}var M=function(){function t(r,e,i,d,u){this.formBuilder=r,this.servProduct=e,this.servCategory=i,this.servPromotion=d,this.authServ=u,this.timepickerConfig=function D(){return Object.assign(new y.Sm,{timeFormat:"hh:mm A",showMeridian:!0,containerClass:"theme-default",hourStep:1,minuteStep:15,readonlyInput:!1,mousewheel:!0,arrowkeys:!0})}(),this.formSaved=new o.vpe,this.addedit_OPmode="",this.defaultDate="1987-06-30",this.isSubmitted=!1,this.isSubmitted_uploadform=!1,this.PromotionTypeList=[],this.ProductList=[],this.bsConfig={dateInputFormat:"YYYY-MM-DD",containerClass:"theme-blue"}}return t.prototype.ngAfterViewInit=function(){this.getPromotionMaster(),this.getProductList()},t.prototype.getPromotionMaster=function(){var r=this;this.servPromotion.getPromotionMast().subscribe(function(e){r.PromotionTypeList=e})},t.prototype.getProductList=function(){var r=this;this.servProduct.getProducts_All().subscribe(function(e){r.ProductList=e})},t.prototype.ngOnInit=function(){this.myForm=this.formBuilder.group({id:[],seller_id:[""],productId:[""],promoType:[""],promotionName:[],buyX:[""],getY:[""],discountAmount:[""],discountPercentage:[""],startDate:["",s.kI.required],endDate:[""]})},t.prototype.ngOnChanges=function(r){return(0,v.mG)(this,void 0,void 0,function(){var e;return(0,v.Jh)(this,function(i){switch(i.label){case 0:return r.param_PromoProd_id?(this.getPromotionMaster(),0==this.param_PromoProd_id?(this.addedit_OPmode="Add",this.myForm.reset()):this.addedit_OPmode="Edit",console.log("detecting change param_PromoProd_id:"+this.param_PromoProd_id),this.param_PromoProd_id?[4,this.get_Product()]:[3,2]):[3,2];case 1:i.sent(),e="",null!=this.authServ.currentUserValue.id&&(e=this.authServ.currentUserValue.id),console.log("patching seller value:"+e),this.myForm.patchValue({id:this.product_Selected.id,seller_id:e,productId:this.product_Selected.productId,promoType:this.product_Selected.promotionType,promotionName:this.product_Selected.promotionName,buyX:this.product_Selected.buyX,getY:this.product_Selected.getY,discountAmount:this.product_Selected.discountAmount,discountPercentage:this.product_Selected.discountPercentage,startDate:this.product_Selected.startDate,endDate:this.product_Selected.endDate}),i.label=2;case 2:return[2]}})})},t.prototype.get_Product=function(){var r=this;return new Promise(function(e,i){r.servPromotion.get_Promotion_ProductById(r.param_PromoProd_id).subscribe(function(d){r.product_Selected=d[0],console.log("m in addedt getting a user:"+JSON.stringify(d)+" abc:"+r.param_PromoProd_id),e(!0)})})},t.prototype.onImageSelected=function(r){this.imageFile=r.target.files[0]},Object.defineProperty(t.prototype,"errorControl",{get:function(){return this.myForm.controls},enumerable:!1,configurable:!0}),t.prototype.onSubmit=function(){var r=this;console.log(this.myForm.value);var e="";null!=this.authServ.currentUserValue.id&&(e=this.authServ.currentUserValue.id),this.myForm.patchValue({seller_id:e}),console.log("this.authServ.currentUserValue!.id:"+e),"Add"==this.addedit_OPmode?(console.log("this.myForm.value:"+JSON.stringify(this.myForm.value)),console.log("PromotionTypeList:"+JSON.stringify(this.PromotionTypeList)),this.servPromotion.addPromotion_Product(this.myForm.value).subscribe(function(i){r.formSaved.emit(!0),r.myForm.reset()})):"Edit"==this.addedit_OPmode&&this.servPromotion.editPromotion_Product(this.myForm.value).subscribe(function(i){r.formSaved.emit(!0),r.myForm.reset()})},t.\u0275fac=function(e){return new(e||t)(o.Y36(s.qu),o.Y36(h.M),o.Y36(_.H),o.Y36(g),o.Y36(P.$))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-product-promotion-add-edit"]],inputs:{param_PromoProd_id:"param_PromoProd_id"},outputs:{formSaved:"formSaved"},features:[o.TTD],decls:45,vars:7,consts:[["autocomplete","off",3,"formGroup","ngSubmit"],[1,"form-group"],["for","product"],["formControlName","productId","required","",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],["for","promotionName"],["type","text","formControlName","promotionName","id","promotionName",1,"form-control"],["for","buyX"],["type","text","formControlName","buyX","id","buyX",1,"form-control"],["for","getY"],["type","text","formControlName","getY","id","getY",1,"form-control"],["for","discountAmount"],["type","text","formControlName","discountAmount","id","discountAmount",1,"form-control"],["for","discountPercentage"],["type","text","formControlName","discountPercentage","id","discountPercentage",1,"form-control"],["for","startDate"],["id","startDate","placeholder","Enter Start Date","bsDatepicker","","formControlName","startDate",1,"form-control",3,"bsConfig"],["for","endDate"],["id","startDate","placeholder","Enter End Date","bsDatepicker","","formControlName","endDate",1,"form-control",3,"bsConfig"],["for","promoType"],["formControlName","promoType","value","apromo.promotionType","required","",1,"form-control"],["type","submit",1,"btn","btn-primary"],[3,"value"],[1,"error"]],template:function(e,i){1&e&&(o.TgZ(0,"p"),o._uU(1,"product-promotion-add-edit works!"),o.qZA(),o.TgZ(2,"form",0),o.NdJ("ngSubmit",function(){return i.onSubmit()}),o.TgZ(3,"div",1)(4,"label",2),o._uU(5,"Product"),o.qZA(),o.TgZ(6,"select",3),o.YNc(7,q,2,2,"option",4),o.qZA(),o.YNc(8,N,2,0,"span",5),o.qZA(),o.TgZ(9,"div",1)(10,"label",6),o._uU(11,"promotionName"),o.qZA(),o._UZ(12,"input",7),o.qZA(),o.TgZ(13,"div",1)(14,"label",8),o._uU(15,"buyX"),o.qZA(),o._UZ(16,"input",9),o.qZA(),o.TgZ(17,"div",1)(18,"label",10),o._uU(19,"getY"),o.qZA(),o._UZ(20,"input",11),o.qZA(),o.TgZ(21,"div",1)(22,"label",12),o._uU(23,"discountAmount"),o.qZA(),o._UZ(24,"input",13),o.qZA(),o.TgZ(25,"div",1)(26,"label",14),o._uU(27,"discountPercentage"),o.qZA(),o._UZ(28,"input",15),o.qZA(),o.TgZ(29,"div",1)(30,"label",16),o._uU(31,"Start Date:"),o.qZA(),o._UZ(32,"input",17),o.qZA(),o.TgZ(33,"div",1)(34,"label",18),o._uU(35,"End Date:"),o.qZA(),o._UZ(36,"input",19),o.qZA(),o.TgZ(37,"div",1)(38,"label",20),o._uU(39,"Category"),o.qZA(),o.TgZ(40,"select",21),o.YNc(41,F,2,2,"option",4),o.qZA(),o.YNc(42,J,2,0,"span",5),o.qZA(),o.TgZ(43,"button",22),o._uU(44,"Submit"),o.qZA()()),2&e&&(o.xp6(2),o.Q6J("formGroup",i.myForm),o.xp6(5),o.Q6J("ngForOf",i.ProductList),o.xp6(1),o.Q6J("ngIf",i.isSubmitted&&(null==i.errorControl.productId.errors?null:i.errorControl.productId.errors.required)),o.xp6(24),o.Q6J("bsConfig",i.bsConfig),o.xp6(4),o.Q6J("bsConfig",i.bsConfig),o.xp6(5),o.Q6J("ngForOf",i.PromotionTypeList),o.xp6(1),o.Q6J("ngIf",i.isSubmitted&&(null==i.errorControl.promoType.errors?null:i.errorControl.promoType.errors.required)))},dependencies:[p.sg,p.O5,s._Y,s.YN,s.Kr,s.Fj,s.EJ,s.JJ,s.JL,s.Q7,s.sg,s.u,m.Np,m.Y5]}),t}(),w=[{path:"",component:f,children:[{path:"",redirectTo:"Product-Promotions",pathMatch:"full"},{path:"Product-Promotions",component:function(){function t(){this.eventsSubject=new Z.xQ}return t.prototype.emitEventToChild=function(){this.eventsSubject.next()},t.prototype.promoProd_Select_Changed_for_Addedit=function(r){this.curr_PromoProd_id_for_Addedit=r},t.prototype.Prod_Select_Changed_for_Detail=function(r){this.curr_Prod_id_for_detail=r},t.prototype.productformSave_Detected=function(r){console.log("in child formSaved detected m in manage seller"),this.curr_PromoProd_id_for_Addedit=null,this.emitEventToChild()},t.prototype.onScroll=function(r){console.log("scrolling...")},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-product-promotions"]],hostBindings:function(e,i){1&e&&o.NdJ("scroll",function(u){return i.onScroll(u)},!1,o.Jf7)},decls:5,vars:2,consts:[[1,"row"],[1,"col-12"],[3,"events","promoproduct_id_for_Addedit","product_id_for_Detail"],[3,"param_PromoProd_id","formSaved"]],template:function(e,i){1&e&&(o.TgZ(0,"div",0)(1,"div",1)(2,"app-display-product-promotion",2),o.NdJ("promoproduct_id_for_Addedit",function(u){return i.promoProd_Select_Changed_for_Addedit(u)})("product_id_for_Detail",function(u){return i.Prod_Select_Changed_for_Detail(u)}),o.qZA()(),o.TgZ(3,"div",1)(4,"app-product-promotion-add-edit",3),o.NdJ("formSaved",function(u){return i.productformSave_Detected(u)}),o.qZA()()()),2&e&&(o.xp6(2),o.Q6J("events",i.eventsSubject.asObservable()),o.xp6(2),o.Q6J("param_PromoProd_id",i.curr_PromoProd_id_for_Addedit))},dependencies:[O,M]}),t}()},{path:"Order-Promotions",component:function(){function t(){this.timepickerConfig=function L(){return Object.assign(new y.Sm,{timeFormat:"hh:mm A",showMeridian:!0,containerClass:"theme-default",hourStep:1,minuteStep:15,readonlyInput:!1,mousewheel:!0,arrowkeys:!0})}()}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-order-promotions"]],decls:5,vars:2,consts:[["for","startTime"],["formControlName","startTime",3,"meridian","hourStep"]],template:function(e,i){1&e&&(o.TgZ(0,"p"),o._uU(1,"order-promotions works!"),o.qZA(),o.TgZ(2,"label",0),o._uU(3,"Start Time:"),o.qZA(),o._UZ(4,"ngb-timepicker",1)),2&e&&(o.xp6(4),o.Q6J("meridian",!0)("hourStep",i.timepickerConfig.hourStep))},dependencies:[s.JJ,s.u]}),t}()}]}],x=function(){function t(){}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[c.Bz.forChild(w),c.Bz]}),t}(),Q=function(){function t(){}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[p.ez,s.u5,s.UX,m.kn.forRoot(),x]}),t}()}}]);